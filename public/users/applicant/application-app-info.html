<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../../images/iyte-comp-logo.png">
    <title>Application</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="../../styles/application.css">
    <script src="https://use.fontawesome.com/releases/v5.12.1/js/all.js" data-search-pseudo-elements> </script>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../../javascript/application-form.js"></script>
</head>

<body>
    <div class="container">

        <!-- Logo and title -->
        <div class="logo-and-title">
            <img class="iztech-logo" src="../../images/iyte-logo.jpg" alt="" width="120" height="120">
            <h3 class="school-title">Izmir Institute Of Technology Graduate Application</h3>
        </div>
        <hr class="">
        <div class="py-5 text-center">
            <h2>Application form</h2>
        </div>

        <!-- Application Form Section -->

        <div class="col-md-12 order-md-1">

            <h4 class="mb-3">Student application information</h4>

            <!-- Student Type Input (foreign, turkish) -->

            <form class="needs-validation" novalidate>

                <div class="mb-3">
                    <label for="departmentSelection">Department To Apply</label>
                    <select class="custom-select" id="departmentSelection" aria-label="">
                        <option selected>Choose...</option>
                    </select>
                    <span class="error-msg" style="color:red;" id="departmentSelection-error"></span>
                </div>


                <div class="mb-3">
                    <label for="studentType">Applicant Type</label>

                    <select class="custom-select" id="studentTypeSelection" aria-label=""
                        onchange="setVisibilityOfPassportInput(this)">
                        <option selected>Choose...</option>
                        <option value="turkish">Turkish Applicant</option>
                        <option value="foreign">Foreign Applicant</option>
                    </select>
                    <span class="error-msg" style="color:red;" id="studentTypeSelection-error"></span>
                </div>

                <div class="mb-3" id="passport-input-field">
                    <label for="passport">Passport (Only foreign students)</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="passport"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="passport-error"></span>
                </div>

                <div class="mb-3">
                    <label for="studentType">Is currently working ?</label>
                    <select class="custom-select" id="isWorking" aria-label="" required
                        onchange="setVisibilityOfPermissionLetterInput(this)">
                        <option selected>Choose...</option>
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                    <span class="error-msg" style="color:red;" id="isWorking-error"></span>
                </div>

                <div id="permission-letters-input" class="mb-3">
                    <label for="passport">Permission Letter (Only working students) </label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="permissionLetter"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="permissionLetter-error"></span>
                </div>


                <div class="mb-3">
                    <label for="photo">Photo</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".jpg,.jpeg,.png" class="custom-file-input" id="photoFile"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="photoFile-error"></span>
                </div>

                <div class="mb-3">
                    <label for="undergrad-transcript">Undergraduate Transcript</label>

                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="underGradTransFile"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="undergradTranscript-error"></span>
                </div>

                <div class="mb-3">
                    <label for="ales-result">ALES Result</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="alesFile"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="alesFile-error"></span>
                </div>

                <div class="mb-3">
                    <label for="english-exam-result">English Exam Result</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="englishFile"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="englishFile-error"></span>
                </div>

                <div class="mb-3">
                    <label for="reference-letters">Reference Letters</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="referenceFiles"
                                aria-describedby="inputGroupFileAddon01" multiple>
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="referenceFiles-error"></span>
                </div>

                <div class="mb-3">
                    <label for="statement-of-purpose">Statement Of Purpose </label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="purposeFile"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="purposeFile-error"></span>
                </div>

                <div class="mb-3">
                    <label for="studentType">Degree to Apply</label>

                    <select class="custom-select" id="degreeSelection" aria-label=""
                        onchange="setVisibilityOfGradTranscriptInput(this)">
                        <option selected>Choose...</option>
                        <option value="phd">PhD</option>
                        <option value="mastersDegree">Master's Degree</option>
                    </select>
                    <span class="error-msg" style="color:red;" id="degreeSelection-error"></span>
                </div>

                <div id="grad-transcript-input">
                    <label for="passport">Master's Degree Transcript</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">.pdf</span>
                        </div>
                        <div class="custom-file">
                            <input type="file" accept=".pdf" class="custom-file-input" id="mastersDegreeTranscript"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                        </div>
                    </div>
                    <span class="error-msg" style="color:red;" id="mastersDegreeTranscript-error"></span>
                </div>


                <hr class="mb-4">
                <div id="buttons">
                    <button class="btn btn-primary btn-lg btn-block" id="create-app" type="button"
                        onclick="submitResult()">Submit</button>
                </div>
            </form>
        </div>
    </div>

    <footer class="my-5 pt-5 text-muted text-center text-small">
        <p class="mb-1">&copy; 1992-2020 Izmir Institute Of Technology</p>
        <ul class="list-inline">
            <li class="list-inline-item"><a href="#">Privacy</a></li>
            <li class="list-inline-item"><a href="#">Terms</a></li>
            <li class="list-inline-item"><a href="#">Support</a></li>
        </ul>
    </footer>
    </div>

    <script src="/__/firebase/7.14.2/firebase-app.js"></script>
    <script src="/__/firebase/7.14.2/firebase-auth.js"></script>
    <script src="/__/firebase/7.14.2/firebase-database.js"></script>
    <script src="/__/firebase/7.14.2/firebase-storage.js"></script>
    <script src="/__/firebase/init.js"></script>
    <script src="//connect.facebook.net/en_US/sdk.js"></script>

    <script>
        FB.init({
            appId: '271875460605718',
            status: true,
            xfbml: true,
            version: 'v2.6'
        });
    </script>

    <script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>
    <meta name="google-signin-client_id"
        content="682877338890-pt2fts6ts1hupjj4ph3duo00eq87t0eb.apps.googleusercontent.com">
    <script>
        firebase.auth().onAuthStateChanged(function (user) {
            if (user) {
                // window.location.href = '/users/applicant/applicant-dashboard';
            } else {
                window.location.href = '/login';
            }
        });

        function onLoad() {
            gapi.load('auth2', function () {
                gapi.auth2.init();
            });
        }

        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                console.log('User signed out.');
            });
            FB.logout(function (response) {
                // Person is now logged out
            });
            firebase.auth().signOut().then(function () {
                window.location.href = "/login"
            }).catch(function (error) {
                console.log(error)
            });
        }
    </script>
    <script>
        var userId;
        firebase.auth().onAuthStateChanged(function (user) {
            userId = firebase.auth().currentUser.uid;
        });
    </script>
    <script>
        fillDepartment();
        $('#create-app').click(function () {
            $('#buttons').html(
                '<button class="btn btn-primary btn-lg btn-block" id="create-app" type="button" disabled><span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...</button>'
            ).addClass('disabled');
        });
        $(".custom-file-input").on("change", function () {
            var length = $(this).get(0).files.length;
            if (length === 0) {
                var fileNames = 'Choose file';
                $(this).siblings(".custom-file-label").addClass("selected").html(fileNames);
            } else if (length === 1) {
                var accepted = $(this).attr("accept").split(",");
                var x = $(this).get(0).files[0].name.split(".");
                var file_ext = x[x.length - 1];
                if (accepted.includes("." + file_ext)) {
                    if ($(this).get(0).files[0].size < 10000000) {
                        var fileNames = '';
                        fileNames += '"' + $(this).get(0).files[0].name + '"';
                        $(this).siblings(".custom-file-label").addClass("selected").html(fileNames);
                    } else {
                        $(this).siblings(".custom-file-label").addClass("selected").html(
                            "File size cannot exceed 10MB.");
                        $(this).get(0).files = null;
                    }
                } else {
                    $(this).siblings(".custom-file-label").addClass("selected").html(
                        "Wrong file format");
                    $(this).get(0).files = null;
                }
            } else if (length === 2) {
                var accepted = $(this).attr("accept").split(",");
                var x = $(this).get(0).files[0].name.split(".");
                var file_ext1 = x[x.length - 1];
                x = $(this).get(0).files[1].name.split(".");
                var file_ext2 = x[x.length - 1];
                if (accepted.includes("." + file_ext1) && accepted.includes("." + file_ext2)) {
                    if ($(this).get(0).files[0].size < 10000000 && $(this).get(0).files[1].size < 10000000) {
                        var fileNames = '';
                        fileNames += '"' + $(this).get(0).files[0].name + '",';
                        fileNames += '"' + $(this).get(0).files[1].name + '"';
                        $(this).siblings(".custom-file-label").addClass("selected").html(fileNames);;
                    } else {
                        $(this).siblings(".custom-file-label").addClass("selected").html(
                            "File size cannot exceed 10MB.");
                        $(this).get(0).files = null;
                    }
                } else {
                    $(this).siblings(".custom-file-label").addClass("selected").html(
                        "Wrong file format");
                    $(this).get(0).files = null;
                }
            } else {
                $(this).siblings(".custom-file-label").addClass("selected").html("Can not select more than 2.");
                $(this).get(0).files = null;
            }
        });
    </script>
</body>

</html>